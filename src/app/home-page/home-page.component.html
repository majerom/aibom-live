<mat-toolbar>
    <span>AIBOM</span>

    <a class="logout" (click)="logout()" href="">Logout</a>
</mat-toolbar>

<section class="search-section">
  <div class="search-section-wrapper">
    <input class="search" [(ngModel)]="searchText" matInput placeholder="Search for Model">
    <button  class="search-btn" (click)="searchModal()" mat-raised-button color="primary">Search</button>
  </div>
</section>

<section class="results-section">
  <div *ngIf="modelData" class="results-section-wrapper">
 
    <h2>{{ modelData?.LLMName }} - {{ modelData?.LLMVersion }}v</h2>
 
    <div class="components-wrapper">
      <div class="componenet-body"> 
        <table *ngIf="modelData" class="table">
          <tbody>
            <tr>
              <td class="w-220"><strong>SPDX Version</strong></td>
              <td>{{ modelData?.spdxVersion }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>Data Licence</strong></td>
              <td>{{ modelData?.dataLicence }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>LLM Name and Version</strong></td>
              <td>{{ modelData?.LLMName }} {{ modelData?.LLMVersion }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>Release Date</strong></td>
              <td>{{ modelData?.releaseDate }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>Author</strong></td>
              <td>{{ authorName?.username }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>Timestamp</strong></td>
              <td>{{ timeStamp }}</td>
            </tr>
            <tr>
              <td class="w-220"><strong>Dependancy Relationship</strong></td>
              <td>{{ modelData?.dependancyRelationship.join(', ') }}</td>
            </tr>
          </tbody>
        </table>
        
        <h3>Vulnerabilities</h3>

        <span *ngIf="vulnarabilities.length === 0 && !isLoading">No vulnarabilities listed </span>
        <span *ngIf="isLoading">Loading data ... </span>
        
        <div *ngIf="vulnarabilities">
          <table mat-table class="table" [dataSource]="dataSource"> 
            <ng-container matColumnDef="id">
              <th class="w-180" mat-header-cell *matHeaderCellDef> CVE </th>
              <td class="w-180" mat-cell *matCellDef="let element"> {{element.cve.id}} </td>
            </ng-container>

            <ng-container matColumnDef="descriptions">
              <th mat-header-cell *matHeaderCellDef> Description </th>
              <td mat-cell *matCellDef="let element"> {{element.cve.descriptions[0].value}} </td>
            </ng-container>
        
            <ng-container matColumnDef="vulnStatus">
              <th mat-header-cell *matHeaderCellDef> Severity </th>
              <td mat-cell *matCellDef="let element"> 
                {{ getBaseSeverity(element) }}
              </td>
 
            </ng-container>
            <ng-container matColumnDef="score">
              <th mat-header-cell *matHeaderCellDef> Score </th>
              <!-- <td mat-cell *matCellDef="let element"> {{element.cve?.metrics?.cvssMetricV31[0]?.cvssData?.baseSeverity ?? "N/A"}} </td> -->
                <td mat-cell *matCellDef="let element">
                  {{ getBaseScore(element) }}
                </td>

            </ng-container>
         
         
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        
          <mat-paginator [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons aria-label="Select page of periodic elements">
          </mat-paginator>
        </div>
        
      </div>
    </div>
  </div>
</section>



